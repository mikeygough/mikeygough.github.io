<!DOCTYPE html>
<html>

<head>
    <title>scatter</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
        }
        /* style tick text */
        /* the axis has a class called tick, with children text and line */
        .tick text {
            font-size: 24px;
        }
    </style>
    <script src="https://unpkg.com/d3@6.7.0/dist/d3.min.js"></script>
</head>

<body>
    <script>
        const { 
            csv,
            select,
            scaleLinear,
            extent,
            axisLeft,
            axisBottom 
        } = d3;

        // Start Tweakables -- 
        const csvUrl = [
                        'https://gist.githubusercontent.com/',
                        'curran/', // User
                        'a08a1080b88344b0c8a7/', // Id of the Gist
                        'raw/0e7a9b0a5d22642a06d3d5b9bcbad9890c8ee534/', // commit
                        'iris.csv', // File name
                        ].join('');
        
        // parse strings into numbers
        const parseRow = (d) => {
            d.sepal_length = +d.sepal_length;
            d.sepal_width = +d.sepal_width;
            d.petal_length = +d.petal_length;
            d.petal_width = +d.petal_width;
            return d;
        };
        
        // set x value, y value
        const xValue = (d) => d.petal_length;
        const yValue = (d) => d.sepal_length;
        // set margin
        const margin = {
            top: 20, 
            right: 20, 
            bottom: 50,
            left: 50,
        };
        // set circle radius
        const radius = 5;

        // set svg attributes for size
        const width = window.innerWidth;
        const height = window.innerHeight;

        // End Tweakables -

        // append svg to dom
        const svg = select('body')
            .append('svg')
            .attr('width', width)
            .attr('height', height)

        // Generic
        const main = async () => {
            const data = await csv(csvUrl, parseRow); // fetch data

            // scaleLinear has a domain and a range. domain is the dataspace, range is the screen space.
            const x = scaleLinear()
                .domain(extent(data, xValue)) // ANOTHER WAY -> .domain([d3.min(data, xValue), d3.max(data, xValue)]); // set the domain (minimum, maximum)
                .range([margin.left, width - margin.right]);

            // start x axis from 0 to max
            // const x = scaleLinear()
            //     .domain([0, d3.max(data, xValue)])
            //     .range([margin.left, width - margin.right]);
            
            const y = scaleLinear()
                .domain(extent(data, yValue))
                .range([height - margin.bottom, margin.top]);

            const marks = data.map(d => ({
                x: x(xValue(d)),
                y: y(yValue(d))
            }));

            svg // data circles
                .selectAll('circle')
                .data(marks)
                .join('circle')
                .attr('cx', (d) => d.x)
                .attr('cy', (d) => d.y)
                .attr('r', radius);

            svg // y axis
                .append('g')
                .attr('transform', `translate(${margin.left}, 0)`)
                .call(axisLeft(y));

            svg // x axis
                .append('g')
                .attr('transform', `translate(0, ${height - margin.bottom})`)
                .call(axisBottom(x));
            
        };

        main();
        // console.log(marks);
        // console.log(x.domain());
        // console.log(x.range());
        // console.log(y.domain());
        // console.log(y.range());
        

    </script>

</body>

</html>